<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="TesterCC">
  <link rel="canonical" href="https://testercc.github.io/sec_research/ic_sec/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>工控安全 - Security Development Notes</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "\u5de5\u63a7\u5b89\u5168";
    var mkdocs_page_input_path = "sec_research\\ic_sec.md";
    var mkdocs_page_url = "/sec_research/ic_sec/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/go.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/ruby.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/php.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'G-PH5YKZNY0N', 'testercc.github.io');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Security Development Notes</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">About the Notes 关于笔记</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Security Development 安全研发</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/learn_guide/">学习指南</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/term/">相关术语</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/sec_dev_lifecycle/">SDL 安全开发流程</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/scanner/">Scanner 扫描器</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/code_sec/">Code Security 代码安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/netflow_analysis/">Netflow Analysis 流量分析</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/log_audit/">Log Audit 日志审计</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/open_source/">Opensource 开源项目推荐</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/skill_tree/">Skill Tree 技能树</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/zero_trust/">Zero Trust 零信任网络</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/dev_sec_ops/">DevSecOps</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/enterprise_security/">Enterprise Security 企业安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/intelligent_risk_control/">Intelligent Risk Control 智能风控</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/pentest_automation/">渗透测试自动化</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/fingerprints/">指纹识别</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/anti_bot/">反爬虫/Bot</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/cl_sqlmap/">源码学习之SqlMap</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/cl_pocsuite/">源码学习之Pocsuite3</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/cl_snort/">源码学习之Snort3</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../secdev/cl_viper/">源码学习之Viper</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Security Research 安全研究</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../research_list/">导航列表</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../exploit/">漏洞挖掘</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../ai_sec/">人工智能安全(AISec)</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../sample_analysis/">样本分析</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../threat_intelligence/">威胁情报</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../apt/">APT</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../att%26ck/">ATT&CK</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../code_audit/">代码审计</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../black_market/">黑产研究</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../binary_sec/">二进制安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../data_sec/">数据安全</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">工控安全</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_2">一、专业术语</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">二、协议和术语科普</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_4">工业控制网络的协议分类</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#1modbus">1.Modbus通讯协议</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#modbus-tcp">Modbus TCP</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#modbus-0x5a">Modbus 0x5a</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#ref">REF</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2siemens-s7">2.Siemens S7协议</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#21-s7comm">2.1 S7comm协议</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3tpkt">3.TPKT</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#4cotp">4.COTP</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_5">其他工控协议</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_6">三、威胁建模</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#_7">安全故障分析模型（物理侧）</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#fat">故障树分析法（FAT）</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#eta">事件树分析法（ETA）</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#stamp">STAMP</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#_8">网络安全威胁模型（信息侧）</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1kill-chain">1.Kill Chain工控模型</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2attck">2.ATT&amp;CK工控模型</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_9">四、威胁模式分析</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_10">五、安全防御</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_11">六、风险评估</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_12">七、工控安全漏洞案例分析</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_13">八、调查取证</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_14">九、攻击分析</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_15">机构工控安全事件分析报告</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#ref_1">REF</a>
    </li>
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../iot_sec/">物联网安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../iov_sec/">车联网安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../cloud_sec/">云原生安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../block_chain_sec/">区块链安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../android_sec/">Android安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../browser_sec/">浏览器安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../protocol_sec/">协议安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../api_sec/">API安全</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../python_sec/">Python安全</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Security Management 安全管理</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../sec_management/cso/">CSO与安全负责人</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../sec_management/enterprise_sec/">企业安全建设</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../sec_management/classified_protection/">等级保护</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../sec_management/sec_jd/">安全招聘</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Security Product Marketing 安全产品营销</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../sec_product/sec_operation/">安全运营</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../sec_product/sec_requirement/">安全需求</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Incident Response 应急响应</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../incident_response/learn_guide/">学习参考</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../incident_response/traceback/">溯源反制</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Pentest 渗透测试</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/learn_guide/">学习参考</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/term/">Term 术语</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/kali_linux/">Kali Linux</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/red_vs_blue/">红蓝对抗</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/red_team/">RedTeam 红队</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/blue_team/">BlueTeam 蓝队</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/brute_force/">Brute Force 暴力破解</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/sql_injection/">SQL Injection SQL注入</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/ddos/">DDoS 分布式拒绝服务</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/xss/">XSS 跨站脚本攻击</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/csrf/">CSRF 跨站请求伪造</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/privilge_escalation/">Privilge Escalation 提权</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/reverse_shell/">Reverse Shell 反弹Shell</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/re/">Reverse Engineering 逆向工程</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/backdoor/">Backdoor 后门</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/crack/">破解</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/attack_lifecycle/">网络攻击生命周期</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/log_clear/">日志清理</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/cve/">CVE</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/report/">报告和笔记</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/nmap/">Nmap</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../pentest/thinkphp5_rce/">ThinkPHP5 RCE</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">CTF</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../ctf/learn_guide/">基础知识</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../ctf/attack_and_defence/">实战攻防演练</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../ctf/env_config/">测试环境搭建</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../ctf/ctf_skill/">CTF竞赛常用基本解题技巧</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../ctf/pwn/">PWN</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../ctf/hackthebox/">Hack The Box</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Algorithm 算法</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../algorithm/learn_guide/">学习指南</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Architecture 架构</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../architecture/learn_guide/">学习指南</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../architecture/design_pattern/">Design Pattern 设计模式</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../architecture/ddd/">DDD 领域驱动设计</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../architecture/micro_services/">Micro Services 微服务</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../architecture/scrum/">Scrum</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Back-end Development 后端开发</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/learn_guide/">学习指南</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/computer_networking/">计算机网络</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/os/">OS 操作系统</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/database/">Database 数据库</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/performance_optimization/">性能优化</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/rpc/">RPC</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/search_engine/">搜索引擎</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/high_concurrency/">高并发</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/python/">Python</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/go/">Golang</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/java/">Java</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/rust/">Rust</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/proxy/">Proxy 代理</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/rabbitmq/">RabbitMQ</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/kafka/">Kafka</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/jwt/">JWT认证</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/big_data/">Big Data 大数据</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/regex/">Regex 正则表达式</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/git/">Git</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/git_flow/">Git Flow</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../backend/vim/">Vim</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Machine Learning 机器学习</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../machine_learning/machine_learning/">机器学习</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../machine_learning/nlp/">自然语言处理</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../machine_learning/statistical_learning/">统计学习方法笔记</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Front-end Development 前端开发</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/learn_guide/">学习指南</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/html5/">HTML5</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/css/">CSS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/js/">JavaScript</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/vue/">Vue.js</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/react/">React</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../frontend/npm/">NPM</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">MOOC Notes 幕课笔记</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../mooc_notes/pku_datastructure/">数据结构与算法Python版</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../mooc_notes/CS_basic/">编程必备基础知识</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Test Development 测试开发</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../testdev/learn_guide/">学习指南</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../testdev/test_management/">测试管理流程</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../testdev/performance/">性能测试</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">软考</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../ruankao/ruankao/">考试相关信息</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../ruankao/system_analyst/">高级系统分析师复习笔记</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../ruankao/system_architect/">高级系统架构设计师复习笔记</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">爬虫开发</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../crawler/cookie_pool/">Cookie池设计</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">DevOps</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../devops/learn_guide/">学习指南</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../devops/docker/">Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../devops/k8s/">Kubernetes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../devops/vm/">VM 虚拟机</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../devops/linux/">Linux</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../devops/windows/">Windows</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../devops/sre/">SRE</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../devops/shell/">Shell</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../devops/syslog/">syslog</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">SEO 搜索引擎优化</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../seo/knowledge/">基本知识</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../seo/whitehat_seo/">白帽SEO</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../seo/blackhat_seo/">黑帽SEO</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Interview 面试</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../interview/navigation/">Navigation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../interview/security/">Security Interview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../interview/backend/">Backend Interview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../interview/ai/">AI Interview</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../interview/qa/">QA Interview</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Academic 学术</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../academic/academic/">Information 相关信息</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Math 数学</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../math/learn_guide/">学习参考</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Others</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../others/introduce/">简介</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../others/learning_view/">Learning View 学习观</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../others/reading_radar/">Reading Radar 读书雷达</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../others/foreign_language/">Foreign Language 外语</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../others/law/">Law 法律</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../others/hugo/">Hugo</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../others/hexo/">Hexo</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../others/english_grammar/">英语语法框架</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../todo_list/">Todo List</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Security Development Notes</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Security Research 安全研究 &raquo;</li>
        
      
    
    <li>工控安全</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="_1">工控安全</h1>
<h2 id="_2">一、专业术语</h2>
<p>SCADA:数据采集与监视控制系统
ICS:工业控制系统
DCS:分布式控制系统/集散控制系统
PCS:过程控制系统ESD:应急停车系统
PLC:可编程序控制器(Programmable Logic Controller)
RTU:远程终端控制系统
IED:智能监测单元HMI:人机界面(Human Machine Interface)
MIS:管理信息系统(Management Information System)
SIS: 生产过程自动化监控和管理系统(Supervisory Information System)
MES:制造执行管理系统</p>
<h2 id="_3">二、协议和术语科普</h2>
<h3 id="_4">工业控制网络的协议分类</h3>
<ul>
<li>传统控制网络：CCS（Coordinated Control System ，协调控制系统）、DCS（Distributed Control System，分布式控制系统）等。</li>
<li>现场总线：CAN、DeviceNet、CCL-Link、Profibus-DP等。</li>
<li>工业以太网：EtherNet/IP、EtherCAT、HSE、Pfofinet、EPA、PowerLink、Modbus、Tenet、Wnet等。</li>
<li>工业无线网：IEEE 802.11(a/b/g/n)、Rfieldbus、ZigBee等。</li>
</ul>
<p>基于控制精度划分为：实时网络协议、非实时网络协议。</p>
<h3 id="1modbus">1.Modbus通讯协议</h3>
<p>Modbus(Modicon's BUS的简称)是一种串行通信协议，是Modicon公司（现在的施耐德电气Schneider Electric）于1979年为使用可编程逻辑控制器（PLC）通信而发表。是全球第一个真正用于工业现场的总线协议。Modbus已经成为工业领域通信协议的业界标准（De facto），并且现在是工业电子设备之间常用的连接方式。
Modbus是一种应用层消息传输协议，位于OSI模型的第7层。通过此协议，控制器之间、控制器经由网络（如以太网）和其他设备之间可以通信。</p>
<p>使用系统保留端口502访问Modbus，这也是TCP/IP协议唯一为工控系统协议保留的端口。</p>
<p>Modbus比其他通信协议使用的更广泛的主要原因有：</p>
<ul>
<li>公开发表并且无版权要求</li>
<li>易于部署和维护</li>
<li>对供应商来说，修改移动本地的比特或字节没有很多限制</li>
</ul>
<p>Modbus允许多个 (大约240个) 设备连接在同一个网络上进行通信，举个例子，一个由测量温度和湿度的装置，并且将结果发送给计算机。在数据采集与监视控制系统（SCADA）中，Modbus通常用来连接监控计算机和远程终端控制系统（RTU）。</p>
<h4 id="modbus-tcp">Modbus TCP</h4>
<p>1997年施耐德推出了基于TCP/IP的Modbus TCP。</p>
<p>可以通过wireshark对Modbus的流量包进行抓取进而观察Modbus TCP的数据格式</p>
<pre><code>Transaction identifier ： 事务标识符
Protocol identifier ： 默认为0
Length : 数据的长度
Unit identifier ： 从机地址，因为使用了TCP/IP所以用ip地址来标识从机，所以该位可忽视，或者做进一步分发
Function code ： modbus的功能码
Data ：具体的数据
</code></pre>

<h4 id="modbus-0x5a">Modbus 0x5a</h4>
<p>DEF CON 25 - Ics Village - Arnaud Soullié - Fun With Modbus 0x5a Nothing New Still Relevant? 
展示过的fun with 0x5a，这个0x5a的功能码是由施耐德自己实现的非标准的功能码，该功能码实现了Modbus标准未允许的功能。在defcon中大佬为我们展示了以下几项：
- 获取项目和PLC信息
- 开启、停止PLC
- 下载程序
- 更改程序</p>
<p><a href="https://github.com/wavestone-cdt/fun-with-modbus-0x5a">fun-with-modbus-0x5a</a>
<a href="https://www.youtube.com/watch?v=A_B69Rifu1g">video</a>
<a href="https://www.riskinsight-wavestone.com/2018/02/fun-with-modbus-0x5a/">Fun with Modbus 0x5A</a></p>
<h4 id="ref">REF</h4>
<ul>
<li><a href="https://www.anquanke.com/post/id/185513">工控安全入门（一）—— Modbus协议</a></li>
<li><a href="https://www.cnblogs.com/Db2k/p/12373388.html">ModbusTCP协议解析 —— 利用Wireshark对报文逐字节进行解析详细解析Modbus所含功能码以及模拟器</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=Mzg3ODY4Nzg3OQ==&amp;mid=2247483711&amp;idx=1&amp;sn=eef542bb5fd00a659161858f2e38849e&amp;chksm=cf0ea2d7f8792bc1c92a606266a17875f08de4cdaca11508ae690c3cbd0919a9e7c70d7cc63f&amp;scene=178&amp;cur_album_id=2112949864471855104#rd">Modbus协议及其攻防</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=Mzg3ODY4Nzg3OQ==&amp;mid=2247483817&amp;idx=1&amp;sn=3e36a7409b965669510ea260216da6a6&amp;chksm=cf0ea241f8792b5740c4401ed658f5f6af94f9fb04e55389342be533c3d3493ad949688bddc7&amp;scene=178&amp;cur_album_id=2175115088809033733#rd">使用Python攻击Modbus协议</a></li>
</ul>
<h3 id="2siemens-s7">2.Siemens S7协议</h3>
<p>属于第7层（应用层）的协议,用于西门子设备之间进行交换数据,通过TSAP,可加载MPI,DP,以太网等不同物理结构总线或网络上,PLC一般可以通过封装好的通讯功能块实现。</p>
<p>S7以太网协议本身也是TCP/IP协议簇的一员，S7协议在OSI中的位置相当于将物理层和数据链路层之上的协议进行了定义，S7comm的协议栈修改程度更高，在应用层组织的数据经过COTP协议、TPKT协议的进一步处理后，最终通过TCP进行传输</p>
<p>更多关于S7协议详细介绍见这里 <a href="https://blog.csdn.net/weixin_43158056/article/details/104298156">工控协议——S7通讯协议</a></p>
<h3 id="21-s7comm">2.1 S7comm协议</h3>
<p>S7comm的结构主要分为三部分：</p>
<ul>
<li>Header：主要是数据的描述性信息，包含长度信息，PDU参考和消息类型常量，最重要的是要表明PDU的类型</li>
<li>Parameter：参数，随着不同类型的PDU会有不同的参数</li>
<li>Data：数据，该数据是一个可选字段来携带数据，例如存储器值，块代码，固件数据等。</li>
</ul>
<p><img alt="S7comm抓包" src="https://cdn.jsdelivr.net/gh/TesterCC/pic_bed3/20220321165710.png" /></p>
<h3 id="3tpkt">3.TPKT</h3>
<p>Transport Service ontop of the TCP，简写：TPKT，通过TCP的传输服务。介于TCP和COTP之间。属于传输服务类的协议，它为上层的COTP和下层TCP进行了过渡。功能为在COTP和TCP之间建立桥梁，其内容包含了上层协议数据包的长度。一般与COTP一起发送，当作Header段。我们常用的RDP协议（remote desktop protocol，windows的远程桌面协议）也是基于TPKT的，TPKT的默认TCP端口为102（RDP为3389）</p>
<h3 id="4cotp">4.COTP</h3>
<p>Connection-Oriented Transport Protocol，即面向连接的传输协议，它的传输必然是依赖于连接的，所以在传输数据前必然有类似TCP握手建立链接的操作。</p>
<h3 id="_5">其他工控协议</h3>
<p>IEC 60870-5-104、EtherNet/IP、Tridium Niagara Fox、Crimson V3、OMRON FINS、PCWorx、ProConOs、MELSEC-Q。按需求自行查阅资料。</p>
<h2 id="_6">三、威胁建模</h2>
<h3 id="_7">安全故障分析模型（物理侧）</h3>
<p>现有的分析评价方法主要包括：故障树分析法、事件树分析法、可靠性框图法、马尔可夫分析法、GO-FLOW法、多层流模型、贝叶斯网络等。</p>
<h4 id="fat">故障树分析法（FAT）</h4>
<p>Fault Tree Analysis</p>
<h4 id="eta">事件树分析法（ETA）</h4>
<p>Event Tree Analysis</p>
<h4 id="stamp">STAMP</h4>
<p>System-Theoretic Accident Model and Process，系统理论模型和流程分析法</p>
<h3 id="_8">网络安全威胁模型（信息侧）</h3>
<p>常见的威胁建模方法：</p>
<p>工控领域主流威胁模型：Kill Chain工控模型、ATT&amp;CK工控模型。</p>
<h4 id="1kill-chain">1.Kill Chain工控模型</h4>
<h4 id="2attck">2.ATT&amp;CK工控模型</h4>
<h2 id="_9">四、威胁模式分析</h2>
<p>主要分析要素：威胁目标对象、威胁向量、威胁影响。</p>
<h2 id="_10">五、安全防御</h2>
<p><img alt="工业互联网安全实施框架" src="https://cdn.jsdelivr.net/gh/TesterCC/pic_bed3/20220222142647.png" /></p>
<h2 id="_11">六、风险评估</h2>
<h2 id="_12">七、工控安全漏洞案例分析</h2>
<ul>
<li>震网攻击：通过改变PLC控制器运行命令，控制离心机异常运行，同时伪造离心机的运行数据，导致SCADA系统的故障诊断功能无法正常运行，最终损坏离心机。</li>
<li>BlackEnergy3：在通过控制断路器切断输电线路的同时，使用DoS攻击电力服务系统。</li>
</ul>
<h2 id="_13">八、调查取证</h2>
<h2 id="_14">九、攻击分析</h2>
<p>因为工控圈信息相对封闭，所以目前公开信息最全的就是西门子（SIEMENS）公司的 PLC s7 - 300/400 启动攻击漏洞，自己实践学习这个工控协议漏洞算是相对容易的。</p>
<p>参考复现资料：
- <a href="https://github.com/ffffffff0x/1earn/blob/master/1earn/Security/ICS/%E5%AE%9E%E9%AA%8C/S7-300%E5%90%AF%E5%81%9C%E5%AE%9E%E9%AA%8C.md">S7-300 启停实验</a>
- <a href="https://www.freebuf.com/articles/ics-articles/212283.html">西门子S7通信过程及重放攻击分析</a>
- <a href="https://www.cnblogs.com/Db2k/p/12376610.html">西门子S7comm协议解析 —— 利用Wireshark对报文逐字节进行解析详细解析S7comm所含功能码以及UserData功能（path1）</a>
- <a href="https://www.cnblogs.com/Db2k/p/12389116.html">西门子S7comm协议解析 —— 利用Wireshark对报文逐字节进行解析详细解析S7comm所含功能码以及UserData功能（path2）</a>
- <a href="https://www.cnblogs.com/Db2k/p/12391974.html">西门子S7comm协议解析 —— 利用Wireshark对报文逐字节进行解析详细解析S7comm所含功能码以及UserData功能（path3）</a>
- <a href="https://blog.csdn.net/weixin_43158056/article/details/104298156">工控协议——S7通讯协议</a>
- <a href="https://github.com/dark-lbp/isf.git">Industrial Exploitation Framework</a></p>
<h2 id="_15">机构工控安全事件分析报告</h2>
<h2 id="ref_1">REF</h2>
<ul>
<li>工业互联网安全：架构与防御</li>
<li>工业控制网络安全技术与实践</li>
<li>工业互联网安全百问百答（科普向）</li>
<li><a href="https://plcscan.org/">灯塔实验室</a></li>
<li><a href="https://www.yuque.com/tidesec/ics/readme">工控安全Wiki - Tide安全团队</a></li>
<li><a href="https://www.anquanke.com/member/141205">工控安全入门系列 1-10</a></li>
<li>公众号：湘雪尘奕（视频挺多的，入门友好，也有后续深入的内容）</li>
<li>公众号SupCERT，工控协议标签</li>
<li><a href="https://www.zhihu.com/question/353268896">如何入门工控安全</a></li>
<li><a href="http://blog.nsfocus.net/ics-safety-monitoring-system/">基于智能学习与业务感知的工控安全监测体系建设</a></li>
<li><a href="https://blog.csdn.net/qq_40229814/article/details/119762675">一种针对工控系统攻击的远程检测方案（工控系统安全）</a></li>
<li><a href="https://blog.csdn.net/liweiminlining/article/details/86624692">工控蜜罐Conpot部署和入门指南</a></li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../iot_sec/" class="btn btn-neutral float-right" title="物联网安全">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../data_sec/" class="btn btn-neutral" title="数据安全"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright © 2021</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../data_sec/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../iot_sec/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
